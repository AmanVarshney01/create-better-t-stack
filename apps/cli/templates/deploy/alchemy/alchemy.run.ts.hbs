///
<reference types="@types/node" />

import alchemy from "alchemy";
{{#if (eq webDeploy "alchemy")}}
{{#if (eq frontend "next")}}
import { Next } from "alchemy/cloudflare";
{{else if (eq frontend "nuxt")}}
import { Nuxt } from "alchemy/cloudflare";
{{else if (eq frontend "svelte")}}
import { SvelteKit } from "alchemy/cloudflare";
{{else if (eq frontend "tanstack-start")}}
import { TanStackStart } from "alchemy/cloudflare";
{{else if (eq frontend "tanstack-router")}}
import { Vite } from "alchemy/cloudflare";
{{else if (eq frontend "react-router")}}
import { ReactRouter } from "alchemy/cloudflare";
{{else if (eq frontend "solid")}}
import { Vite } from "alchemy/cloudflare";
{{/if}}
{{/if}}
{{#if (eq serverDeploy "alchemy")}}
import { Worker } from "alchemy/cloudflare";
{{/if}}

const app = await alchemy("{{projectName}}");

{{#if (eq webDeploy "alchemy")}}
{{#if (eq frontend "next")}}
export const website = await Next("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./.output/server/index.mjs",
// command: "next build",
// dev: { command: "next dev" },
});
{{else if (eq frontend "nuxt")}}
export const website = await Nuxt("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./.output/server/index.mjs",
// command: "nuxt build",
// dev: { command: "nuxt dev" },
});
{{else if (eq frontend "svelte")}}
export const website = await SvelteKit("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./.output/server/index.mjs",
// command: "vite build",
// dev: { command: "vite dev" },
});
{{else if (eq frontend "tanstack-start")}}
export const website = await TanStackStart("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./.output/server/index.mjs",
// command: "vite build",
// dev: { command: "vite dev" },
});
{{else if (eq frontend "tanstack-router")}}
export const website = await Vite("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./dist/server/index.js",
// command: "vite build",
// dev: { command: "vite dev" },
assets: "dist"
});
{{else if (eq frontend "react-router")}}
export const website = await ReactRouter("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "build/server/index.js",
// command: "react-router build",
// dev: { command: "react-router dev" },
});
{{else if (eq frontend "solid")}}
export const website = await Vite("website", {
name: `${app.name}-${app.stage}-website`,
// replace if different from default:
//
// main: "./dist/server/index.js",
// command: "vite build",
// dev: { command: "vite dev" },
assets: "dist"
});
{{/if}}
{{/if}}

{{#if (eq serverDeploy "alchemy")}}
export const worker = await Worker("worker", {
name: `${app.name}-${app.stage}`,
entrypoint: "{{#if (eq webDeploy "alchemy")}}apps/server/src/worker.ts{{else}}src/worker.ts{{/if}}",
});
{{/if}}

{{#if (and (eq webDeploy "alchemy") (eq serverDeploy "alchemy"))}}
console.log({
website: website.url,
worker: worker.url,
});
{{else if (eq webDeploy "alchemy")}}
console.log({
url: website.url,
});
{{else if (eq serverDeploy "alchemy")}}
console.log(worker.url);
{{/if}}

await app.finalize();