import alchemy from "alchemy";
{{#if (eq webDeploy "alchemy")}}
{{#if (includes frontend "next")}}
import { Next } from "alchemy/cloudflare";
{{else if (includes frontend "nuxt")}}
import { Nuxt } from "alchemy/cloudflare";
{{else if (includes frontend "svelte")}}
import { SvelteKit } from "alchemy/cloudflare";
{{else if (includes frontend "tanstack-start")}}
import { TanStackStart } from "alchemy/cloudflare";
{{else if (includes frontend "tanstack-router")}}
import { Vite } from "alchemy/cloudflare";
{{else if (includes frontend "react-router")}}
import { ReactRouter } from "alchemy/cloudflare";
{{else if (includes frontend "solid")}}
import { Vite } from "alchemy/cloudflare";
{{/if}}
{{/if}}
{{#if (eq serverDeploy "alchemy")}}
import { Worker } from "alchemy/cloudflare";
{{/if}}

const app = await alchemy("{{projectName}}");

{{#if (eq webDeploy "alchemy")}}
{{#if (includes frontend "next")}}
export const web = await Next("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`
});
{{else if (includes frontend "nuxt")}}
export const web = await Nuxt("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`
});
{{else if (includes frontend "svelte")}}
export const web = await SvelteKit("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`
});
{{else if (includes frontend "tanstack-start")}}
export const web = await TanStackStart("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`
});
{{else if (includes frontend "tanstack-router")}}
export const web = await Vite("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`,
  assets: "dist"
});
{{else if (includes frontend "react-router")}}
export const web = await ReactRouter("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`
});
{{else if (includes frontend "solid")}}
export const web = await Vite("web", {
  {{#if (eq serverDeploy "alchemy")}}cwd: "apps/web",{{/if}}
  name: `${app.name}-${app.stage}-web`,
  assets: "dist"
});
{{/if}}
{{/if}}

{{#if (eq serverDeploy "alchemy")}}
export const server = await Worker("server", {
  {{#if (eq webDeploy "alchemy")}}cwd: "apps/server",{{/if}}
  name: `${app.name}-${app.stage}`,
  entrypoint: "src/index.ts",
  compatibility: "node"
});
{{/if}}

{{#if (and (eq webDeploy "alchemy") (eq serverDeploy "alchemy"))}}
console.log(`\nWeb: ${web.url}`);
console.log(`Server: ${server.url}`);
{{else if (eq webDeploy "alchemy")}}
console.log(`\nWeb: ${web.url}`);
{{else if (eq serverDeploy "alchemy")}}
console.log(`\nServer: ${server.url}`);
{{/if}}

await app.finalize();