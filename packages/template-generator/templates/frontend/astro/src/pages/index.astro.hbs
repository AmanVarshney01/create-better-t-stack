---
import Layout from "../layouts/Layout.astro";
{{#if (eq api "orpc")}}
import { orpc } from "../lib/orpc";
{{/if}}

const TITLE_TEXT = `
 ██████╗ ███████╗████████╗████████╗███████╗██████╗
 ██╔══██╗██╔════╝╚══██╔══╝╚══██╔══╝██╔════╝██╔══██╗
 ██████╔╝█████╗     ██║      ██║   █████╗  ██████╔╝
 ██╔══██╗██╔══╝     ██║      ██║   ██╔══╝  ██╔══██╗
 ██████╔╝███████╗   ██║      ██║   ███████╗██║  ██║
 ╚═════╝ ╚══════╝   ╚═╝      ╚═╝   ╚══════╝╚═╝  ╚═╝

 ████████╗    ███████╗████████╗ █████╗  ██████╗██╗  ██╗
 ╚══██╔══╝    ██╔════╝╚══██╔══╝██╔══██╗██╔════╝██║ ██╔╝
    ██║       ███████╗   ██║   ███████║██║     █████╔╝
    ██║       ╚════██║   ██║   ██╔══██║██║     ██╔═██╗
    ██║       ███████║   ██║   ██║  ██║╚██████╗██║  ██╗
    ╚═╝       ╚══════╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝
 `;
---

<Layout title="{{projectName}}">
  <div class="container mx-auto max-w-3xl px-4 py-2">
    <pre class="overflow-x-auto font-mono text-sm text-white">{TITLE_TEXT}</pre>
    <div class="grid gap-6">
      {{#if (eq api "orpc")}}
      <section class="rounded-lg border border-neutral-700 p-4">
        <h2 class="mb-2 font-medium text-white">API Status</h2>
        <div class="flex items-center gap-2" id="api-status">
          <div class="h-2 w-2 rounded-full bg-orange-400" id="status-dot"></div>
          <span class="text-sm text-neutral-400" id="status-text">Checking...</span>
        </div>
      </section>
      {{/if}}
    </div>
  </div>
</Layout>

{{#if (eq api "orpc")}}
<script>
  import { orpc } from "../lib/orpc";

  const statusDot = document.getElementById("status-dot")!;
  const statusText = document.getElementById("status-text")!;

  async function checkHealth() {
    try {
      const data = await orpc.healthCheck();
      statusDot.className = "h-2 w-2 rounded-full bg-green-500";
      statusText.textContent = "Connected";
    } catch (error) {
      statusDot.className = "h-2 w-2 rounded-full bg-red-500";
      statusText.textContent = "Disconnected";
    }
  }

  checkHealth();
</script>
{{/if}}
